<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UTCD Interactive Demo</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-card: #334155;
            --accent: #2dd4bf;
            --accent-dim: rgba(45, 212, 191, 0.1);
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 50px;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--text-primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .demo-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .demo-grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .card h3 {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--accent);
            margin-bottom: 20px;
        }

        .select-group {
            margin-bottom: 15px;
        }

        .select-group label {
            display: block;
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        select {
            width: 100%;
            padding: 12px 15px;
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            transition: border-color 0.2s;
        }

        select:hover {
            border-color: var(--accent);
        }

        select:focus {
            outline: none;
            border-color: var(--accent);
        }

        .tool-info {
            background: var(--bg-card);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .tool-info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 0.9rem;
        }

        .tool-info-row:last-child {
            border-bottom: none;
        }

        .tool-info-row .label {
            color: var(--text-secondary);
        }

        .tool-info-row .value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }

        .result-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 30px;
            border: 2px solid transparent;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .result-card.approved {
            border-color: var(--success);
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.1);
        }

        .result-card.warning {
            border-color: var(--warning);
            box-shadow: 0 0 30px rgba(245, 158, 11, 0.1);
        }

        .result-card.rejected {
            border-color: var(--danger);
            box-shadow: 0 0 30px rgba(239, 68, 68, 0.1);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .result-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .result-icon.approved {
            background: rgba(34, 197, 94, 0.2);
        }

        .result-icon.warning {
            background: rgba(245, 158, 11, 0.2);
        }

        .result-icon.rejected {
            background: rgba(239, 68, 68, 0.2);
        }

        .result-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .result-title.approved { color: var(--success); }
        .result-title.warning { color: var(--warning); }
        .result-title.rejected { color: var(--danger); }

        .score-bar {
            background: var(--bg-card);
            border-radius: 8px;
            height: 12px;
            overflow: hidden;
            margin: 20px 0;
        }

        .score-fill {
            height: 100%;
            border-radius: 8px;
            transition: width 0.5s ease;
        }

        .score-fill.high { background: var(--success); }
        .score-fill.medium { background: var(--warning); }
        .score-fill.low { background: var(--danger); }

        .score-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .reasoning {
            margin-top: 20px;
        }

        .reasoning h4 {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--accent);
            margin-bottom: 15px;
        }

        .reason-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 0.9rem;
        }

        .reason-item:last-child {
            border-bottom: none;
        }

        .reason-icon {
            flex-shrink: 0;
            width: 20px;
            text-align: center;
        }

        .reason-pass { color: var(--success); }
        .reason-fail { color: var(--danger); }
        .reason-warn { color: var(--warning); }

        footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }

        footer a {
            color: var(--accent);
            text-decoration: none;
            font-weight: 500;
        }

        footer a:hover {
            text-decoration: underline;
        }

        .github-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--accent-dim);
            padding: 12px 24px;
            border-radius: 8px;
            margin-top: 15px;
            transition: background 0.2s;
        }

        .github-link:hover {
            background: rgba(45, 212, 191, 0.2);
            text-decoration: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>UTCD Interactive Demo</h1>
            <p class="subtitle">See how AI agents reason about tools before execution</p>
        </header>

        <div class="demo-grid">
            <div class="card">
                <h3>1. Select Policy</h3>
                <div class="select-group">
                    <label>Agent Policy</label>
                    <select id="policySelect">
                        <option value="strict">üîí Strict ‚Äî No side effects allowed</option>
                        <option value="standard" selected>‚öñÔ∏è Standard ‚Äî Balanced safety</option>
                        <option value="gdpr">üá™üá∫ GDPR ‚Äî EU data residency required</option>
                        <option value="permissive">üü¢ Permissive ‚Äî Warnings only</option>
                    </select>
                </div>
                <div class="tool-info" id="policyInfo">
                    <div class="tool-info-row">
                        <span class="label">Side Effects</span>
                        <span class="value" id="policySideEffects">filesystem allowed</span>
                    </div>
                    <div class="tool-info-row">
                        <span class="label">Data Retention</span>
                        <span class="value" id="policyRetention">session only</span>
                    </div>
                    <div class="tool-info-row">
                        <span class="label">Data Location</span>
                        <span class="value" id="policyLocation">any</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>2. Select Tool</h3>
                <div class="select-group">
                    <label>Tool to Evaluate</label>
                    <select id="toolSelect">
                        <option value="file-reader">üìÑ File Reader ‚Äî Safe, read-only</option>
                        <option value="csv-analyzer">üìä CSV Analyzer ‚Äî GDPR compliant</option>
                        <option value="email-sender">üìß Email Sender ‚Äî Network access</option>
                        <option value="code-executor">‚ö†Ô∏è Code Executor ‚Äî Dangerous</option>
                    </select>
                </div>
                <div class="tool-info" id="toolInfo">
                    <div class="tool-info-row">
                        <span class="label">Side Effects</span>
                        <span class="value" id="toolSideEffects">none</span>
                    </div>
                    <div class="tool-info-row">
                        <span class="label">Data Retention</span>
                        <span class="value" id="toolRetention">none</span>
                    </div>
                    <div class="tool-info-row">
                        <span class="label">Data Location</span>
                        <span class="value" id="toolLocation">local</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="result-card" id="resultCard">
            <div class="result-header">
                <div class="result-icon approved" id="resultIcon">‚úì</div>
                <div class="result-title approved" id="resultTitle">APPROVED</div>
            </div>

            <div class="score-label">
                <span>Safety Score</span>
                <span id="scoreValue">85/100</span>
            </div>
            <div class="score-bar">
                <div class="score-fill high" id="scoreFill" style="width: 85%"></div>
            </div>

            <div class="reasoning">
                <h4>UTCD Reasoning</h4>
                <div id="reasoningList">
                    <div class="reason-item">
                        <span class="reason-icon reason-pass">‚úì</span>
                        <span>No dangerous side effects detected</span>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p style="color: var(--text-secondary);">UTCD ‚Äî Universal Tool Capability Descriptor</p>
            <a href="https://github.com/Data-with-rajan/UTCD" target="_blank" class="github-link">
                <span>‚≠ê</span>
                <span>View on GitHub</span>
            </a>
        </footer>
    </div>

    <script>
        // Tool definitions (simulating UTCD files)
        const tools = {
            'file-reader': {
                name: 'File Reader',
                sideEffects: ['none'],
                dataRetention: 'none',
                dataLocation: 'local',
                domain: 'filesystem'
            },
            'csv-analyzer': {
                name: 'CSV Analyzer',
                sideEffects: ['none'],
                dataRetention: 'session',
                dataLocation: 'EU',
                domain: 'data-processing',
                gdprCompliant: true
            },
            'email-sender': {
                name: 'Email Sender',
                sideEffects: ['net:http-outbound'],
                dataRetention: 'persistent',
                dataLocation: 'US',
                domain: 'communication'
            },
            'code-executor': {
                name: 'Code Executor',
                sideEffects: ['fs:write', 'net:any', 'proc:spawn'],
                dataRetention: 'persistent',
                dataLocation: 'any',
                domain: 'execution'
            }
        };

        // Policy definitions
        const policies = {
            'strict': {
                name: 'Strict',
                allowedSideEffects: ['none'],
                maxRetention: 'none',
                requiredLocation: null
            },
            'standard': {
                name: 'Standard',
                allowedSideEffects: ['none', 'fs:read'],
                maxRetention: 'session',
                requiredLocation: null
            },
            'gdpr': {
                name: 'GDPR',
                allowedSideEffects: ['none', 'fs:read', 'net:http-outbound'],
                maxRetention: 'session',
                requiredLocation: 'EU'
            },
            'permissive': {
                name: 'Permissive',
                allowedSideEffects: ['any'],
                maxRetention: 'persistent',
                requiredLocation: null,
                warningsOnly: true
            }
        };

        function evaluate() {
            const policyKey = document.getElementById('policySelect').value;
            const toolKey = document.getElementById('toolSelect').value;
            
            const policy = policies[policyKey];
            const tool = tools[toolKey];

            // Update tool info display
            document.getElementById('toolSideEffects').textContent = tool.sideEffects.join(', ');
            document.getElementById('toolRetention').textContent = tool.dataRetention;
            document.getElementById('toolLocation').textContent = tool.dataLocation;

            // Update policy info display
            document.getElementById('policySideEffects').textContent = 
                policy.allowedSideEffects[0] === 'any' ? 'any allowed' : policy.allowedSideEffects.join(', ') + ' allowed';
            document.getElementById('policyRetention').textContent = policy.maxRetention + ' max';
            document.getElementById('policyLocation').textContent = policy.requiredLocation || 'any';

            // Evaluate
            let score = 100;
            let reasons = [];
            let decision = 'approved';

            // Check side effects
            const hasDangerousSideEffects = tool.sideEffects.some(e => 
                e !== 'none' && !policy.allowedSideEffects.includes(e) && policy.allowedSideEffects[0] !== 'any'
            );
            
            if (hasDangerousSideEffects) {
                score -= 40;
                reasons.push({
                    pass: policy.warningsOnly,
                    message: `Side effects [${tool.sideEffects.join(', ')}] exceed policy limits`
                });
                if (!policy.warningsOnly) decision = 'rejected';
            } else {
                reasons.push({
                    pass: true,
                    message: 'Side effects within policy limits'
                });
            }

            // Check data retention
            const retentionLevels = { 'none': 0, 'session': 1, 'persistent': 2 };
            if (retentionLevels[tool.dataRetention] > retentionLevels[policy.maxRetention]) {
                score -= 25;
                reasons.push({
                    pass: policy.warningsOnly,
                    message: `Data retention "${tool.dataRetention}" exceeds policy max "${policy.maxRetention}"`
                });
                if (!policy.warningsOnly) decision = 'rejected';
            } else {
                reasons.push({
                    pass: true,
                    message: 'Data retention compliant'
                });
            }

            // Check data location
            if (policy.requiredLocation && tool.dataLocation !== policy.requiredLocation) {
                score -= 35;
                reasons.push({
                    pass: false,
                    message: `Data location "${tool.dataLocation}" violates required "${policy.requiredLocation}"`
                });
                decision = 'rejected';
            } else if (policy.requiredLocation) {
                reasons.push({
                    pass: true,
                    message: `Data location "${tool.dataLocation}" meets requirement`
                });
            }

            // Clamp score
            score = Math.max(0, score);

            // Determine final decision
            if (decision !== 'rejected' && score < 50) {
                decision = 'warning';
            }

            // Update UI
            updateResult(decision, score, reasons);
        }

        function updateResult(decision, score, reasons) {
            const card = document.getElementById('resultCard');
            const icon = document.getElementById('resultIcon');
            const title = document.getElementById('resultTitle');
            const scoreFill = document.getElementById('scoreFill');
            const scoreValue = document.getElementById('scoreValue');
            const reasoningList = document.getElementById('reasoningList');

            // Remove old classes
            card.className = 'result-card ' + decision;
            icon.className = 'result-icon ' + decision;
            title.className = 'result-title ' + decision;

            // Update content
            const icons = { approved: '‚úì', warning: '‚ö†', rejected: '‚úó' };
            const titles = { approved: 'APPROVED', warning: 'WARNING', rejected: 'REJECTED' };
            
            icon.textContent = icons[decision];
            title.textContent = titles[decision];
            scoreValue.textContent = score + '/100';
            
            // Update score bar
            scoreFill.style.width = score + '%';
            scoreFill.className = 'score-fill ' + (score >= 70 ? 'high' : score >= 40 ? 'medium' : 'low');

            // Update reasoning
            reasoningList.innerHTML = reasons.map(r => `
                <div class="reason-item">
                    <span class="reason-icon ${r.pass ? 'reason-pass' : 'reason-fail'}">${r.pass ? '‚úì' : '‚úó'}</span>
                    <span>${r.message}</span>
                </div>
            `).join('');
        }

        // Event listeners
        document.getElementById('policySelect').addEventListener('change', evaluate);
        document.getElementById('toolSelect').addEventListener('change', evaluate);

        // Initial evaluation
        evaluate();
    </script>
</body>
</html>
